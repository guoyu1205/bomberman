# Rust 炸弹人游戏 (Bomberman)

## 游戏简介
一个使用 Rust + Bevy 引擎开发的经典炸弹人游戏，具有完整的游戏流程、智能敌人AI、音效系统和精美的视觉效果。

## 技术栈
- **语言**: Rust
- **游戏引擎**: Bevy 0.10.1
- **类型**: 网格式策略动作游戏

## 游戏特色

### ✨ 完整的游戏流程
- 🎬 **欢迎界面** - 游戏说明和操作指引
- 🎮 **游戏进行** - 流畅的游戏体验
- ⏸️ **暂停功能** - 背景变暗效果
- 🏆 **胜利结算** - 消灭所有敌人
- 💀 **失败结算** - 被炸弹击中

### 🎯 游戏玩法

#### 操作说明
- **移动**: 
  - `W` / `↑` - 向上移动
  - `S` / `↓` - 向下移动
  - `A` / `←` - 向左移动
  - `D` / `→` - 向右移动
  - **支持长按连续移动**
- **放置炸弹**: `空格键`
- **暂停游戏**: `P` 键
- **恢复游戏**: `R` 键（暂停状态下）
- **返回主菜单**: `ESC` 键（暂停状态下）
- **开始/重新开始**: `ENTER` 键

#### 游戏目标与机制
- 🎯 使用炸弹消灭所有敌人（怪物生物）
- 💣 炸弹放置后3秒爆炸，爆炸范围2格（十字型）
- 🧱 炸弹会炸毁可破坏的墙体，但无法穿透不可破坏的墙
- 👾 敌人会智能移动（每0.5秒移动一格），碰到障碍物会随机改变方向
- ⚠️ 避免被自己的炸弹炸到，也要避免与敌人碰撞
- 🏆 消灭所有3个敌人即可获胜
- 💀 被炸弹炸到或与敌人碰撞会导致失败



## 运行游戏

### 前置要求
- Rust 工具链（推荐使用 rustup 安装）

### 编译
```bash
cargo build
```

### 运行
```bash
cargo run
```

## 项目结构
```
src/
├── main.rs         # 主程序入口，资源加载
├── components.rs   # ECS组件定义
├── constants.rs    # 游戏常量配置
├── resource.rs     # 游戏资源和状态定义
├── map.rs          # 地图系统
├── player.rs       # 玩家控制系统
├── bomb.rs         # 炸弹和爆炸系统
├── enemy.rs        # 敌人系统
└── ui.rs           # UI界面系统
assets/
├── images/         # 游戏图片资源
└── fonts/          # 字体资源
```

## 技术亮点

### 🏗️ 架构设计
- ✅ **ECS架构** - 使用Bevy的实体-组件-系统模式
- ✅ **状态机管理** - 完整的游戏状态流转
- ✅ **网格系统** - 13x13的精确网格地图
- ✅ **碰撞检测** - 基于网格的高效碰撞检测
- ✅ **资源管理** - 统一的纹理和字体管理

### 🎮 游戏系统
- ✅ **流畅移动** - 玩家基于时间的连续移动，敌人离散移动（每0.5秒）
- ✅ **智能爆炸** - 十字型爆炸范围计算，正确处理墙体阻挡，不穿透不可破坏墙
- ✅ **敌人AI系统** - 3个敌人自动移动，碰到障碍物随机改变方向，碰撞检测
- ✅ **状态系统** - Welcome → InGame → Paused/Victory/GameOver，带1秒延迟转场
- ✅ **UI系统** - 完整的界面提示和状态展示，暂停带半透明遮罩效果
- ✅ **音效系统** - 放置炸弹、爆炸、玩家/敌人死亡、胜利/失败音效
- ✅ **胜负判定** - 自动检测游戏结束条件（玩家死亡或敌人全灭）

### 🎨 视觉效果
- ✅ **精灵动画系统** - 使用TextureAtlas精灵图集，流畅的角色和特效动画
- ✅ **精美图片** - 玩家、敌人、墙体、炸弹、火焰等完整美术资源
- ✅ **暂停遮罩** - 暂停时70%透明度黑色遮罩效果
- ✅ **爆炸特效** - 火焰精灵图集，十字型爆炸视觉效果
- ✅ **固定窗口** - 780x780像素窗口，13x13网格（每格60像素）


## 游戏流程说明

### 欢迎界面（Welcome）
- 显示游戏标题"BOMBERMAN"和完整操作说明
- 按 ENTER 开始游戏

### 游戏进行中（InGame）
- 玩家在左上角（1,1）位置出生
- 3个敌人分布在地图三个角落：右上（11,1）、右下（11,11）、左下（1,11）
- 13x13网格地图，包含不可破坏墙（边界+内部网格）和可破坏墙（零散分布）
- 使用炸弹开辟道路并消灭敌人
- 敌人会主动移动，注意躲避

### 暂停界面（Paused）
- 按 P 键暂停游戏，背景变暗（70%透明黑色遮罩）
- 显示"PAUSED"字样和操作提示
- 所有实体停止移动，炸弹计时器暂停
- 按 R 继续游戏，按 ESC 返回主菜单

### 胜利界面（Victory）
- 消灭所有3个敌人后，1秒延迟后自动显示
- 显示"VICTORY!"字样和"All enemies defeated"
- 播放胜利音效
- 按 ENTER 重新开始游戏

### 失败界面（GameOver）
- 被炸弹击中或与敌人碰撞后，1秒延迟后显示
- 显示"GAME OVER!"字样和"You were blown up"
- 播放失败音效
- 按 ENTER 重新开始游戏

## 开发环境
- **OS**: Windows 11
- **Rust**: 2021 Edition
- **Bevy**: 0.10.1

## 核心实现亮点

### 1. ECS架构设计
- 使用Bevy的实体-组件-系统（ECS）模式
- 组件化设计：Player、Enemy、Bomb、Explosion、Wall等独立组件
- 系统化更新：玩家移动、敌人AI、炸弹计时、碰撞检测等独立系统

### 2. 状态机管理
- 五种游戏状态：Welcome、InGame、Paused、Victory、GameOver
- 状态转换时自动清理/创建实体
- 暂停功能使用Stop组件标记，不切换状态

### 3. 网格系统
- 13x13精确网格定位
- 网格坐标与世界坐标的双向转换
- 基于网格的高效碰撞检测

### 4. 智能爆炸算法
- 十字型爆炸传播（上下左右四个方向）
- 正确处理墙体阻挡（不可破坏墙和可破坏墙）
- 单次爆炸可以同时检测并摧毁多个目标

### 5. 敌人AI系统
- 离散网格移动（每0.5秒移动一格）
- 碰到障碍物（墙体、炸弹）自动随机改变方向
- 实时检测与玩家的碰撞

### 6. 音效系统
- 6种音效：放置炸弹、炸弹爆炸、玩家死亡、敌人死亡、胜利、失败
- 支持WAV和OGG格式
- 精细的音量控制（20%）

### 未来扩展方向

- [ ] **道具系统** - 增加爆炸范围、移动速度、炸弹数量等道具
- [ ] **多关卡系统** - 关卡选择、难度递增、关卡数据配置
- [ ] **背景音乐（BGM）** - 游戏主题音乐循环播放
- [ ] **更智能的敌人AI** - 追踪玩家、躲避炸弹、协同攻击
- [ ] **更多地图样式** - 随机地图生成、预设地图关卡


## 依赖项

```toml
[dependencies]
bevy = { version = "0.10.1", features = ["wav"] }
rand = "0.8.5"
```

主要依赖：
- **Bevy 0.10.1** - 游戏引擎（启用wav音频支持）
- **rand 0.8.5** - 随机数生成（用于敌人随机移动方向）

## 开源协议
MIT License

---

**祝您游戏愉快！💣💥🎮**
